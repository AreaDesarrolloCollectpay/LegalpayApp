$( function() {    
    //btn see more items legal
    $('.see-more').click(function(e){
        e.preventDefault();
        var _this = $(this);
        var attr = _this.attr('data-page');        
        var idState = _this.parent().siblings('.connectedSortable').attr('id');                
        _this.parent().addClass("hide");
        _this.next().removeClass("hide");
        
        // For some browsers, `attr` is undefined; for others, `attr` is false. Check for both.
        if (typeof attr !== typeof undefined && attr !== false) {
          // Element has this attribute
            $('#form-filter-page').val(attr).change();
        }           
        getLegal(_this,idState);
    });
});

function getLegal(_this,idState){
    var formElement = document.getElementById('form-filter-debtors');
    var form = new FormData(formElement); 
    form.append("idState", idState);
    
    $.ajax({
        url: SITEURL + '/wallet/legal',
        dataType: 'json',
        method: 'POST',
        data: form,
        processData: false,
        contentType: false,
        success: function(result) {
            if(result.status == "success"){
                $("#form-filter-page").val('1');
                _this.attr('data-page',result.page);                    
                $('#'+result.id).append(result.html);                    
                if(result.more){
                    $(_this).parent().removeClass('hide');
                    $(_this).next().addClass('hide');
                }else{
                    $(_this).parent().addClass('hide');
                    $(_this).next().addClass('hide');
                }
            }
        }
    });
}

$(window).on('load', function() {
    setTimeout(function(){
        $('#m-wallets').trigger('click');
        $('#m-dashboard').addClass('active');
    },250);  
});