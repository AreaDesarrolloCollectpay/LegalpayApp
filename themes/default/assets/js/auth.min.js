$(function () {
    //  form login

    $('body').on('submit', '.form-login', function (e) {
        e.preventDefault();
        var form = new FormData(this);
        $.ajax({
            url: SITEURL + "/site/login",
            dataType: 'json',
            type: 'POST',
            data: form,
            processData: false,
            contentType: false,
            beforeSend: function () {
                $(".preload").fadeIn(300);
            },
            success: function (result) {
                if (result.status == "success") {
                    setTimeout(function(){
                        location.href = result.url;                        
                    },800);
                } else {
                    $(".preload").fadeOut(300);
                    toastr[result.status](result.msg);
                    grecaptcha.reset();
                }
            }
        });
    });
    // Recover Password
    $('body').on('submit', '.form-recover-pass', function (e) {
        e.preventDefault();
        var form = new FormData(this);
        $.ajax({
            url: SITEURL + "/site/recover",
            dataType: 'json',
            type: 'POST',
            data: form,
            processData: false,
            contentType: false,
            beforeSend: function () {
                $(".preload").fadeIn(300);
            },
            success: function (result) {
                $(".preload").fadeOut(300);
                toastr[result.status](result.msg);
                if (result.status == "success"){
                    setTimeout(function(){
                        $('#modal-recover').closeModal();
                        $(".form-recover-pass")[0].reset();
                    },800);
                }
            }
        });
    });
    
    // form register
    
    $('body').on('submit', '.form-register', function (e) {
        e.preventDefault();
        var form = new FormData(this);
        $.ajax({
            url: SITEURL + "/site/register",
            dataType: 'json',
            type: 'POST',
            data: form,
            processData: false,
            contentType: false,
            beforeSend: function () {
                $(".preload").fadeIn(300);
            },
            success: function (result) {
                $(".preload").fadeOut(300);
                toastr[result.status](result.msg);
                setTimeout(function(){
                    if (result.status == "success") {
                        $(".form-register")[0].reset(); 
                        $('.register-show').click();   
                    }
                },800);
            }
        });
    });
    
    
    // form confirm 
    
    $('body').on('submit', '.form-confirm', function (e) {
        e.preventDefault();
        var form = new FormData(this);
        $.ajax({
            url: SITEURL + "/site/confirmAccount",
            dataType: 'json',
            type: 'POST',
            data: form,
            processData: false,
            contentType: false,
            beforeSend: function () {
                $(".preload").fadeIn(300);
            },
            success: function (result) {
                $(".preload").fadeOut(300);
                toastr[result.status](result.msg);
                setTimeout(function(){
                    if (result.status == "success") {
                        $(".form-confirm")[0].reset();                    
                        location.href = SITEURL+result.url;                         
                    }
                },800);
            }
        });
    });
    
    $('body').on('click', '.back-login', function (e) {
        e.preventDefault();
        $('.register-show').click();           
        console.log('click2');
   });
    

});


